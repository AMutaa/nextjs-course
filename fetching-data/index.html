<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/nextjs-course/styles.54f5cd0e961e9221efb0.css">code[class*=language-],pre[class*=language-]{color:#d4d4d4;font-size:.9em;text-shadow:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e}:not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;color:#db4c69;background:#1e1e1e}.namespace{opacity:.7}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#6a9955}.token.punctuation{color:#d4d4d4}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#b5cea8}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#ce9178}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#d4d4d4}.token.atrule,.token.attr-value,.token.keyword{color:#c586c0}.token.function{color:#dcdcaa}.token.important,.token.regex,.token.variable{color:#d16969}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.constant{color:#9cdcfe}.token.class-name{color:#4ec9b0}.token.interpolation,.token.parameter{color:#9cdcfe}.token.boolean,.token.punctuation.interpolation-punctuation{color:#569cd6}.token.property{color:#9cdcfe}.token.selector{color:#d7ba7d}.token.tag{color:#569cd6}.token.attr-name{color:#9cdcfe}.token.attr-value{color:#ce9178}.token.entity{color:#4ec9b0;cursor:unset}.token.namespace,code[class*=language-javascript],pre[class*=language-javascript]{color:#4ec9b0}code[class*=language-css],pre[class*=language-css]{color:#ce9178}code[class*=language-html],pre[class*=language-html]{color:#d4d4d4}.language-html .token.punctuation{color:grey}pre[data-line]{position:relative}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}.line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#f7ebc6;box-shadow:inset 5px 0 0 #f7d87c;z-index:0;pointer-events:none;line-height:inherit;white-space:pre}.command-line-prompt>span:before,.language-shell code:first-child:before{content:"$ ";color:#999}.light-theme code[class*=language-],.light-theme pre[class*=language-]{text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#90a4ae;background:#fafafa;font-family:Roboto Mono,monospace;font-size:.9em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.light-theme code[class*=language-]::selection,.light-theme code[class*=language-] ::selection,.light-theme pre[class*=language-]::selection,.light-theme pre[class*=language-] ::selection{background:#cceae7;color:#263238}.light-theme :not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;color:#db4c69;background:#fafafa}.light-theme pre[class*=language-]{overflow:auto;position:relative;margin:.5em 0;padding:1.25em 1em}.light-theme .language-css>code,.light-theme .language-sass>code,.light-theme .language-scss>code{color:#f76d47}.light-theme [class*=language-] .namespace{opacity:.7}.light-theme .token.atrule{color:#7c4dff}.light-theme .token.attr-name{color:#39adb5}.light-theme .token.attr-value,.light-theme .token.attribute{color:#f6a434}.light-theme .token.boolean{color:#7c4dff}.light-theme .token.builtin,.light-theme .token.cdata,.light-theme .token.char,.light-theme .token.class{color:#39adb5}.light-theme .token.class-name{color:#6182b8}.light-theme .token.comment{color:#aabfc9}.light-theme .token.constant{color:#7c4dff}.light-theme .token.deleted{color:#e53935}.light-theme .token.doctype{color:#aabfc9}.light-theme .token.entity{color:#e53935}.light-theme .token.function{color:#7c4dff}.light-theme .token.hexcode{color:#f76d47}.light-theme .token.id,.light-theme .token.important{color:#7c4dff;font-weight:700}.light-theme .token.inserted{color:#39adb5}.light-theme .token.keyword{color:#7c4dff}.light-theme .token.number{color:#f76d47}.light-theme .token.operator{color:#39adb5}.light-theme .token.prolog{color:#aabfc9}.light-theme .token.property{color:#39adb5}.light-theme .token.pseudo-class,.light-theme .token.pseudo-element{color:#f6a434}.light-theme .token.punctuation{color:#39adb5}.light-theme .token.regex{color:#6182b8}.light-theme .token.selector{color:#e53935}.light-theme .token.string{color:#f6a434}.light-theme .token.symbol{color:#7c4dff}.light-theme .token.tag{color:#e53935}.light-theme .token.unit{color:#f76d47}.light-theme .token.url,.light-theme .token.variable{color:#e53935}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}</style><meta name="generator" content="Gatsby 2.24.14"/><title data-react-helmet="true">Fetching Data – Data Fetching – Intro to Next.js</title><meta data-react-helmet="true" name="og:title" content="Fetching Data – Data Fetching – Intro to Next.js"/><meta data-react-helmet="true" name="description" content="Learn Next.js with Scott Moss and Frontend Masters"/><meta data-react-helmet="true" name="og:description" content="Learn Next.js with Scott Moss and Frontend Masters"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="og:url" content="https://hendrixer.github.io/nextjs-course/fetching-data"/><meta data-react-helmet="true" name="keywords" content="react, next.js, javascript, frontend masters, learn javascript"/><style type="text/css">
    .header-link.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .header-link.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .header-link svg,
    h2 .header-link svg,
    h3 .header-link svg,
    h4 .header-link svg,
    h5 .header-link svg,
    h6 .header-link svg {
      visibility: hidden;
    }
    h1:hover .header-link svg,
    h2:hover .header-link svg,
    h3:hover .header-link svg,
    h4:hover .header-link svg,
    h5:hover .header-link svg,
    h6:hover .header-link svg,
    h1 .header-link:focus svg,
    h2 .header-link:focus svg,
    h3 .header-link:focus svg,
    h4 .header-link:focus svg,
    h5 .header-link:focus svg,
    h6 .header-link:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link as="script" rel="preload" href="/nextjs-course/webpack-runtime-4d379543a0b0ecbb4ad5.js"/><link as="script" rel="preload" href="/nextjs-course/framework-17193c917176a9ab3be2.js"/><link as="script" rel="preload" href="/nextjs-course/styles-d34d6d50c68384cf0a65.js"/><link as="script" rel="preload" href="/nextjs-course/app-c3b2018b72754eada9af.js"/><link as="script" rel="preload" href="/nextjs-course/component---src-templates-lesson-template-js-e03a676a5fcdc65581e8.js"/><link as="fetch" rel="preload" href="/nextjs-course/page-data/fetching-data/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/nextjs-course/static/d/2959687377.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/nextjs-course/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="rtvbe2">body{--theme-ui-colors-text:var(--theme-ui-colors-text,rgba(255,255,255,0.82));--theme-ui-colors-background:var(--theme-ui-colors-background,#121212);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#FF1744);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#17ffd1);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#212121);--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,#29112c);--theme-ui-colors-gray:var(--theme-ui-colors-gray,#999);--theme-ui-colors-purple:var(--theme-ui-colors-purple,#c0f);--theme-ui-colors-surface:var(--theme-ui-colors-surface,rgb(25,25,25));--theme-ui-colors-surface2:var(--theme-ui-colors-surface2,rgb(30,30,30));--theme-ui-colors-bright:var(--theme-ui-colors-bright,white);color:var(--theme-ui-colors-text,rgba(255,255,255,0.82));background-color:var(--theme-ui-colors-background,#121212);}body.theme-ui-dark{--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#121212);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#212121);--theme-ui-colors-surface:var(--theme-ui-colors-modes-dark-surface,rgb(25,25,25));--theme-ui-colors-surface2:var(--theme-ui-colors-modes-dark-surface2,rgb(30,30,30));--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#FF1744);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#17ffd1);--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,rgba(255,255,255,0.82));--theme-ui-colors-bright:var(--theme-ui-colors-modes-dark-bright,white);}body.theme-ui-light{--theme-ui-colors-text:var(--theme-ui-colors-modes-light-text,#121212);--theme-ui-colors-background:var(--theme-ui-colors-modes-light-background,#efefef);--theme-ui-colors-surface:var(--theme-ui-colors-modes-light-surface,white);--theme-ui-colors-surface2:var(--theme-ui-colors-modes-light-surface2,white);--theme-ui-colors-bright:var(--theme-ui-colors-modes-light-bright,black);--theme-ui-colors-muted:var(--theme-ui-colors-modes-light-muted,rgba(0,0,0,0.12));--theme-ui-colors-primary:var(--theme-ui-colors-modes-light-primary,#B39DDB);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-light-secondary,#E91E63);}</style><style data-emotion-css="11sk4f5">*{box-sizing:border-box;}body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-size:20px;font-weight:400;line-height:1.5;}body a{-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-secondary,#17ffd1);font-weight:700;}body a:hover{-webkit-text-decoration:underline;text-decoration:underline;}body h1,body h2,body h3,body h4,body h5,body h6{color:var(--theme-ui-colors-bright,white);margin-top:25px;margin-bottom:25px;}body p{margin-top:15px;margin-bottom:15px;}body blockquote{padding:14px;color:var(--theme-ui-colors-text,rgba(255,255,255,0.82));border-left:.25em solid;border-color:var(--theme-ui-colors-primary,#FF1744);margin:0;margin-top:7px;margin-bottom:7px;background-color:var(--theme-ui-colors-background,#121212);}body blockquote p{margin:0;font-style:italic;}body img{background-color:var(--theme-ui-colors-background,#121212);}body li p{margin:0;}body li{margin-top:14px;margin-bottom:14px;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><style data-emotion-css="zvjckt">.css-zvjckt{z-index:9999;height:60px;background-color:var(--theme-ui-colors-surface2,rgb(30,30,30));padding:14px;box-shadow:0 1px 3px rgba(0,0,0,0.12),0 1px 2px rgba(0,0,0,0.24);position:fixed;top:0;left:0;width:100%;}</style><nav class="css-zvjckt"><style data-emotion-css="19n52h3">.css-19n52h3{width:100%;max-width:960px;margin-top:0;margin-bottom:0;margin-left:auto;margin-right:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><div class="css-19n52h3"><style data-emotion-css="15uw0ls">.css-15uw0ls{padding-left:14px;padding-right:14px;}</style><div class="css-15uw0ls"><a href="/nextjs-course/"><style data-emotion-css="tvgpiv">.css-tvgpiv{width:50px;color:var(--theme-ui-colors-text,rgba(255,255,255,0.82));}</style><div class="css-tvgpiv"><svg viewBox="0 0 148 90" version="1.1" style="transform:translateX(4%);shape-rendering:auto"><path d="M34.992 23.495h27.855v2.219H37.546v16.699h23.792v2.219H37.546v18.334h25.591v2.219H34.992v-41.69zm30.35 0h2.96l13.115 18.334 13.405-18.334L113.055.207 83.1 43.756l15.436 21.429H95.46L81.417 45.683 67.316 65.185h-3.018L79.85 43.756 65.343 23.495zm34.297 2.219v-2.219h31.742v2.219h-14.623v39.47h-2.554v-39.47H99.64zM.145 23.495h3.192l44.011 66.003L29.16 65.185 2.814 26.648l-.116 38.537H.145v-41.69zm130.98 38.801c-.523 0-.914-.405-.914-.928 0-.524.391-.929.913-.929.528 0 .913.405.913.929 0 .523-.385.928-.913.928zm2.508-2.443H135c.019.742.56 1.24 1.354 1.24.888 0 1.391-.535 1.391-1.539v-6.356h1.391v6.362c0 1.808-1.043 2.849-2.77 2.849-1.62 0-2.732-1.01-2.732-2.556zm7.322-.08h1.379c.118.853.95 1.395 2.149 1.395 1.117 0 1.937-.58 1.937-1.377 0-.685-.521-1.097-1.708-1.377l-1.155-.28c-1.62-.38-2.36-1.166-2.36-2.487 0-1.602 1.304-2.668 3.26-2.668 1.82 0 3.15 1.066 3.23 2.58h-1.354c-.13-.828-.85-1.346-1.894-1.346-1.1 0-1.832.53-1.832 1.34 0 .642.472 1.01 1.64 1.284l.987.243c1.838.43 2.596 1.178 2.596 2.53 0 1.72-1.33 2.799-3.453 2.799-1.987 0-3.323-1.029-3.422-2.637z" fill="currentColor" fill-rule="nonzero"></path></svg></div></a></div><div class="css-15uw0ls"><style data-emotion-css="1uk1gs8">.css-1uk1gs8{margin:0;}</style><h3 class="css-1uk1gs8">Data Fetching – Fetching Data</h3></div><div><style data-emotion-css="1vrzlx6">.css-1vrzlx6{text-align:center;font-size:1.2em;color:var(--theme-ui-colors-text,rgba(255,255,255,0.82));background:transparent;border:none;outline:none;padding-left:14px;padding-right:14px;padding-top:7px;padding-bottom:7px;cursor:pointer;border-radius:4px;}</style><button class="css-1vrzlx6">🌛</button></div></div></nav><style data-emotion-css="blksvd">.css-blksvd{width:100vw;max-width:960px;margin-top:60px;margin-bottom:0;margin-left:auto;margin-right:auto;}</style><div class="css-blksvd"><style data-emotion-css="67ytwe">.css-67ytwe{padding-top:28px;padding-bottom:28px;}</style><div class="css-67ytwe"><div><style data-emotion-css="1ybhnik">.css-1ybhnik{background-color:var(--theme-ui-colors-surface,rgb(25,25,25));padding:28px;box-shadow:0 3px 6px rgba(0,0,0,0.16),0 3px 6px rgba(0,0,0,0.23);border-radius:4px;}</style><div class="css-1ybhnik"><style data-emotion-css="1uk1gs8">.css-1uk1gs8{margin:0;}</style><h1 class="css-1uk1gs8">Fetching Data</h1><h2 class="css-1uk1gs8"></h2><div><p>There are many ways to fetch data with Next.js. Depending on when you need the data and what you're doing with it, you have options.</p>
<p>Let's start with what you already know. You can continue to fetch the data client-side to react the same way you do now. Hooks, fetch, etc.</p>
<blockquote>
<p>👍🏾  <strong>tip</strong>: Next.js injects <code class="language-text">fetch</code> into your environment.</p>
</blockquote>
<blockquote>
<p>👍🏾  <strong>tip</strong>: Checkout <a href="https://swr.vercel.app/">swr</a> and <a href="https://react-query.tanstack.com/">react-query</a> for your client side data fetching needs.</p>
</blockquote>
<p>Now, for fetching data ahead time, we have three options.</p>
<p><code class="language-text">getStaticProps</code></p>
<p><code class="language-text">getStaticPaths</code></p>
<p><code class="language-text">getServerSideProps</code></p>
<h2 id="static-data" style="position:relative;"><a href="#static-data" aria-label="static data permalink" class="header-link before"><svg aria-hidden="true" fill="currentColor" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Static data</h2>
<p>All of these methods are for prerendering Pages only. You cannot use them in components or client-side data fetching. Let's talk about <code class="language-text">getStaticProps</code> on a page.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// /pages/index.js</span>

<span class="token keyword">const</span> <span class="token function-variable function">IndexPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token comment">// jsx }</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>By having your page export <code class="language-text">getStaticPros</code>, Next.js will run this function at <strong>build time</strong>. Whatever your return as props will be passed into the exported page.</p>
<blockquote>
<p>🕳   <strong>deep dive</strong>: The results of this function are saved into a JSON file and passed as props to the client's component at runtime.</p>
</blockquote>
<p>This function and all other data fetching functions will only ever run on the server. The actual code won't even be bundled with the client code. That means you can do some exciting things here:</p>
<ul>
<li>file system work</li>
<li>connect to a DB</li>
<li>crawl a website? Yup.</li>
</ul>
<p>The <code class="language-text">context</code> object is useful when the page is dynamic. The context will contain the value of the params. This function is not run at runtime in the browser, so where do the params come in?</p>
<p>That's where <code class="language-text">getStaticPaths</code> come in.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// /pages/blog/:slug.js</span>

<span class="token keyword">const</span> <span class="token function-variable function">IndexPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token comment">// jsx }</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// get all the paths for your posts from an API</span>
  <span class="token comment">// or file system</span>
  <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/posts'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token keyword">await</span> results<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> paths <span class="token operator">=</span> posts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">post</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>slug<span class="token operator">:</span> 
  post<span class="token punctuation">.</span>slug<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">/*
  [
    {params: {slug: 'get-started-with-node'}},
    {params: {slug: 'top-frameworks'}}
  ]
  */</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>paths<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> params <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/post/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>slug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>post<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="static-paths" style="position:relative;"><a href="#static-paths" aria-label="static paths permalink" class="header-link before"><svg aria-hidden="true" fill="currentColor" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Static paths</h2>
<p>If a page has a dynamic path <code class="language-text">[id].jsx</code> and uses <code class="language-text">getStaticProps</code>, it must also use <code class="language-text">getStaticPaths</code> to prerender all the pages at build time into HTML.</p>
<blockquote>
<p>👍🏾  <strong>tip</strong>: use <code class="language-text">fallback: true</code> on your return object for <code class="language-text">getStaticPaths</code> if you have a big site and don't want to statically prerender all items at once, and instead opt in to render some later at runtime via SSR.</p>
</blockquote>
<h2 id="server-data" style="position:relative;"><a href="#server-data" aria-label="server data permalink" class="header-link before"><svg aria-hidden="true" fill="currentColor" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Server data</h2>
<p>Lastly we have <code class="language-text">getServerSideProps</code>. This will be called at runtime during every request. So unlike <code class="language-text">getStaticProps</code>, you will have the runtime data like query params, HTTP headers, and the req and res objects from API handlers. </p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">IndexPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token comment">// jsx }</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getServerSideProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://somedata.com</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> props<span class="token operator">:</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="when-to-use-what" style="position:relative;"><a href="#when-to-use-what" aria-label="when to use what permalink" class="header-link before"><svg aria-hidden="true" fill="currentColor" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When to use what</h2>
<p><strong>Do you need data at runtime but don't need SSR?</strong>
Use client-side data fetching.</p>
<p><strong>Do you need data at runtime but do need SSR?</strong>
Use <code class="language-text">getServerSideProps</code></p>
<p><strong>Do you have pages that rely on data that is cachable and accessible at build time? Like from a CMS?</strong>
Use <code class="language-text">getStaticProps</code></p>
<p><strong>Do you have the same as above but the pages have dynamic URL params?</strong>
Use <code class="language-text">getStaticProps</code> and <code class="language-text">getStaticPaths</code></p>
<h2 id="fetch-notes" style="position:relative;"><a href="#fetch-notes" aria-label="fetch notes permalink" class="header-link before"><svg aria-hidden="true" fill="currentColor" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fetch notes</h2>
<p>We won't get into creating a UI to create notes, so let's just seed our in-memory DB with some notes.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// src/data/data</span>
<span class="token keyword">const</span> notes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">,</span>
    title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Note </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>Let's fetch some notes from our API in our app now.
First, getting all the notes. Because the notes can be created and are dynamic, we can fetch them client-side or server-side render. Let's do the latter. </p>
<blockquote>
<p>⚠️   <strong>warning</strong>: Don't use <code class="language-text">getServerSideProps</code> unless absolutely necessary. Because it computes on every requests, it can be slow.</p>
</blockquote>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// pages/note/index.jsx</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getServerSideProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:3000/api/note/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>notes<span class="token operator">:</span> data<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We'll do the same for getting one note. Except, we'll redirect if the request fails.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getServerSideProps</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>params<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:3000/api/note/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

  <span class="token comment">// so much power!</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">302</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> Location<span class="token operator">:</span> <span class="token string">'/notes'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>props<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      props<span class="token operator">:</span> <span class="token punctuation">{</span>note<span class="token operator">:</span> data<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Next, we'll simulate a CMS and fetch the content for the landing page.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/** @jsx jsx */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> jsx <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'theme-ui'</span>
<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'next/link'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>content<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">sx</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> height<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">calc(100vh - 60px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">sx</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>variant<span class="token operator">:</span> <span class="token string">'containers.page'</span><span class="token punctuation">,</span> display<span class="token operator">:</span> <span class="token string">'flex'</span><span class="token punctuation">,</span> alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">sx</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>fontSize<span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> my<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>content<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span> 
<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      content<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'Look at my note app tho'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Next.js just keeps improving when it comes to data fetching; it's by far my favorite part. Little to no overhead and extremely powerful. It makes developing open-source that integrates with Next.js a breeze.</p>
<blockquote>
<p>🌲   <strong>branch</strong>: <code class="language-text">git checkout data-fetching</code></p>
</blockquote></div></div><style data-emotion-css="1jnzseq">.css-1jnzseq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;margin-top:28px;margin-bottom:28px;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><div class="css-1jnzseq"><style data-emotion-css="1d4d29s">.css-1d4d29s{padding-left:14px;padding-right:14px;padding-top:7px;padding-bottom:7px;color:var(--theme-ui-colors-bright,white);background-color:var(--theme-ui-colors-primary,#FF1744);border-radius:4px;-webkit-text-decoration:none !important;text-decoration:none !important;}</style><a class="css-1d4d29s" href="/nextjs-course/api-handlers">← API Handlers</a><a class="css-1d4d29s" href="/nextjs-course/rendering-modes">Rendering Modes →</a></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/fetching-data";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a974cabd1631c4c2c55e.js"],"app":["/app-c3b2018b72754eada9af.js"],"component---src-pages-404-js":["/component---src-pages-404-js-04b24e5a5b3a350763a8.js"],"component---src-pages-index-js":["/component---src-pages-index-js-63a49efe88b84c9394b6.js"],"component---src-templates-lesson-template-js":["/component---src-templates-lesson-template-js-e03a676a5fcdc65581e8.js"]};/*]]>*/</script><script src="/nextjs-course/polyfill-a974cabd1631c4c2c55e.js" nomodule=""></script><script src="/nextjs-course/component---src-templates-lesson-template-js-e03a676a5fcdc65581e8.js" async=""></script><script src="/nextjs-course/app-c3b2018b72754eada9af.js" async=""></script><script src="/nextjs-course/styles-d34d6d50c68384cf0a65.js" async=""></script><script src="/nextjs-course/framework-17193c917176a9ab3be2.js" async=""></script><script src="/nextjs-course/webpack-runtime-4d379543a0b0ecbb4ad5.js" async=""></script></body></html>